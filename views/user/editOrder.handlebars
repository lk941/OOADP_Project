<style>
    /* General */
body {
  background-color: #ff6600;
}

::placeholder {
  color: #7b7e81;
  opacity: 1; /* Firefox */
}

:-ms-input-placeholder { /* Internet Explorer 10-11 */
  color: #7b7e81;
}

::-ms-input-placeholder { /* Microsoft Edge */
  color: #7b7e81;
}

textarea:focus, 
input:focus, 
input[type]:focus{   
  box-shadow: 0 0 5px #7b4acb;
}

textarea {
  resize: none;
}

/* Header */
.header__wrapper {
  padding: 25px 0; 
}

.header__wrapper h3 {
  font-style: italic;
}

/* Main body */
.container {
  max-width: 800px;
  margin: 50px auto;
}

.container h2 {
  text-align: center;
  margin-bottom: 50px;
  font-weight: 400;
}

.form__wrapper {
  color:#ff6600;
  background-color: #E3E2DF;
  padding: 40px 40px 58px;
  margin: 100px auto 95px;
  box-shadow: 0 19px 38px rgba(0,0,0,0.3), 0 15px 12px rgba(0,0,0,0.22);
}

.form__btns {
  text-align: center;
}

.form__btns button {
  min-width: 95px;
  margin: 24px 15px 0;
}

.form-control {
  color: black;
  background-color: #E3E2DF;
  border-radius: 0;
}

textarea.form-control {
  height: 39px;
}

.form__comments label:not(:first-child){
  margin-top: 32px;
}

.form-group {
  margin-bottom: 2rem;
}

/* Footer*/
footer {
  color: #E3E2DF;
  opacity: 0.8;
}

footer a {
  color: #5D001E;
}

footer a:hover {
  color: #5D001E;
  text-decoration: underline;
}

.text-small {
  font-size: .8rem;
}

/* Responsive */
@media (min-width: 576px) { 

  .form__btns button {
    min-width: 125px;
    margin: 24px 20px 0;
  }
  
}

#editBttn {
  color: black;
  border-color: #5D001E;
  margin-left: 1%;
  margin-right: 1%;
}

#editBttns:hover {
  background-color: #ff6600;
  color:#E3E2DF;
  border-color: #ff6600;
}

.editInputField:focus {
  box-shadow: 0 0 5px black !important;
  background-color: #E3E2DF;
  color: black;
  border-color: black;
}

.layout {
  font-weight: lighter;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: flex;
  align-items: center;
  justify-content: center;
}

.select2-results__option {
  color: #555;
}

.flag-text {
  margin-left: 10px;
}

.theModal {
  text-align:center;
  margin: 0 auto;
}

</style>

<div class="container form__wrapper"> 
  <h2>Edit Order</h2>
  <form id="myForm" action="/editOrder/{{order.id}}?_method=PUT" method="post" onsubmit="changeCountry()">
    <input type="hidden" name="_method" value="PUT">
    <div class="form-row">
      <div class="form-group col-md-6" style="border: 1px solid #ced4da;">
        <fieldset>
          <label id="addressLabel" for="address">Address</label>
          <input name="address" type="text" class="form-control editInputField" id="address" placeholder="Address" onkeypress="check()" onblur="check()">
          <label id="streetLabel" for="street">Street</label>
          <input name="street" type="text" class="form-control editInputField" id="street" placeholder="Street" onkeypress="check()" onblur="check()">
          <label id="destinationLabel" style="display:none;" for="destination">Location</label>
          <textarea style="display:none; height: 20vh;" name="destination" type="text" class="form-control editInputField" id="destination" placeholder="Destination" disabled>{{order.destination}}</textarea>
          <label id="locationLabel" style="display:none;" for="location">Location</label>
          <textarea style="display:none; height: 20vh;" name="location" type="text" class="form-control editInputField" id="location" placeholder="Location" disabled>{{product.origin}}</textarea>
          <br>
          <label for="country">Country</label>
          <div class="layout">
            <select class="form-control ediInputField" id="country" name="country" style="background-color:#E3E2DF; color: black;" onkeypress="check()" onblur="check()">
              <option>Choose your country</option>
              <option value="AF">Afghanistan</option>,<option value="AX">Ã…land Islands</option>,<option value="AL">Albania</option>,<option value="DZ">Algeria</option>,<option value="AS">American Samoa</option>,<option value="AD">Andorra</option>,<option value="AO">Angola</option>,<option value="AI">Anguilla</option>,<option value="AQ">Antarctica</option>,<option value="AG">Antigua and Barbuda</option>,<option value="AR">Argentina</option>,<option value="AM">Armenia</option>,<option value="AW">Aruba</option>,<option value="AU">Australia</option>,<option value="AT">Austria</option>,<option value="AZ">Azerbaijan</option>,<option value="BS">Bahamas</option>,<option value="BH">Bahrain</option>,<option value="BD">Bangladesh</option>,<option value="BB">Barbados</option>,<option value="BY">Belarus</option>,<option value="BE">Belgium</option>,<option value="BZ">Belize</option>,<option value="BJ">Benin</option>,<option value="BM">Bermuda</option>,<option value="BT">Bhutan</option>,<option value="BO">Bolivia</option>,<option value="BA">Bosnia and Herzegovina</option>,<option value="BW">Botswana</option>,<option value="BV">Bouvet Island</option>,<option value="BR">Brazil</option>,<option value="IO">British Indian Ocean Territory</option>,<option value="BN">Brunei Darussalam</option>,<option value="BG">Bulgaria</option>,<option value="BF">Burkina Faso</option>,<option value="BI">Burundi</option>,<option value="KH">Cambodia</option>,<option value="CM">Cameroon</option>,<option value="CA">Canada</option>,<option value="CV">Cape Verde</option>,<option value="KY">Cayman Islands</option>,<option value="CF">Central African Republic</option>,<option value="TD">Chad</option>,<option value="CL">Chile</option>,<option value="CN">China</option>,<option value="CX">Christmas Island</option>,<option value="CC">Cocos (Keeling) Islands</option>,<option value="CO">Colombia</option>,<option value="KM">Comoros</option>,<option value="CG">Congo</option>,<option value="CD">Congo, The Democratic Republic of the</option>,<option value="CK">Cook Islands</option>,<option value="CR">Costa Rica</option>,<option value="CI">Cote D'Ivoire</option>,<option value="HR">Croatia</option>,<option value="CU">Cuba</option>,<option value="CY">Cyprus</option>,<option value="CZ">Czech Republic</option>,<option value="DK">Denmark</option>,<option value="DJ">Djibouti</option>,<option value="DM">Dominica</option>,<option value="DO">Dominican Republic</option>,<option value="EC">Ecuador</option>,<option value="EG">Egypt</option>,<option value="SV">El Salvador</option>,<option value="GQ">Equatorial Guinea</option>,<option value="ER">Eritrea</option>,<option value="EE">Estonia</option>,<option value="ET">Ethiopia</option>,<option value="FK">Falkland Islands (Malvinas)</option>,<option value="FO">Faroe Islands</option>,<option value="FJ">Fiji</option>,<option value="FI">Finland</option>,<option value="FR">France</option>,<option value="GF">French Guiana</option>,<option value="PF">French Polynesia</option>,<option value="TF">French Southern Territories</option>,<option value="GA">Gabon</option>,<option value="GM">Gambia</option>,<option value="GE">Georgia</option>,<option value="DE">Germany</option>,<option value="GH">Ghana</option>,<option value="GI">Gibraltar</option>,<option value="GR">Greece</option>,<option value="GL">Greenland</option>,<option value="GD">Grenada</option>,<option value="GP">Guadeloupe</option>,<option value="GU">Guam</option>,<option value="GT">Guatemala</option>,<option value="GG">Guernsey</option>,<option value="GN">Guinea</option>,<option value="GW">Guinea-Bissau</option>,<option value="GY">Guyana</option>,<option value="HT">Haiti</option>,<option value="HM">Heard Island and Mcdonald Islands</option>,<option value="VA">Holy See (Vatican City State)</option>,<option value="HN">Honduras</option>,<option value="HK">Hong Kong</option>,<option value="HU">Hungary</option>,<option value="IS">Iceland</option>,<option value="IN">India</option>,<option value="ID">Indonesia</option>,<option value="IR">Iran, Islamic Republic Of</option>,<option value="IQ">Iraq</option>,<option value="IE">Ireland</option>,<option value="IM">Isle of Man</option>,<option value="IL">Israel</option>,<option value="IT">Italy</option>,<option value="JM">Jamaica</option>,<option value="JP">Japan</option>,<option value="JE">Jersey</option>,<option value="JO">Jordan</option>,<option value="KZ">Kazakhstan</option>,<option value="KE">Kenya</option>,<option value="KI">Kiribati</option>,<option value="KP">Korea, Democratic People's Republic of</option>,<option value="KR">Korea, Republic of</option>,<option value="KW">Kuwait</option>,<option value="KG">Kyrgyzstan</option>,<option value="LA">Lao People's Democratic Republic</option>,<option value="LV">Latvia</option>,<option value="LB">Lebanon</option>,<option value="LS">Lesotho</option>,<option value="LR">Liberia</option>,<option value="LY">Libyan Arab Jamahiriya</option>,<option value="LI">Liechtenstein</option>,<option value="LT">Lithuania</option>,<option value="LU">Luxembourg</option>,<option value="MO">Macao</option>,<option value="MK">Macedonia, The Former Yugoslav Republic of</option>,<option value="MG">Madagascar</option>,<option value="MW">Malawi</option>,<option value="MY">Malaysia</option>,<option value="MV">Maldives</option>,<option value="ML">Mali</option>,<option value="MT">Malta</option>,<option value="MH">Marshall Islands</option>,<option value="MQ">Martinique</option>,<option value="MR">Mauritania</option>,<option value="MU">Mauritius</option>,<option value="YT">Mayotte</option>,<option value="MX">Mexico</option>,<option value="FM">Micronesia, Federated States of</option>,<option value="MD">Moldova, Republic of</option>,<option value="MC">Monaco</option>,<option value="MN">Mongolia</option>,<option value="MS">Montserrat</option>,<option value="MA">Morocco</option>,<option value="MZ">Mozambique</option>,<option value="MM">Myanmar</option>,<option value="NA">Namibia</option>,<option value="NR">Nauru</option>,<option value="NP">Nepal</option>,<option value="NL">Netherlands</option>,<option value="AN">Netherlands Antilles</option>,<option value="NC">New Caledonia</option>,<option value="NZ">New Zealand</option>,<option value="NI">Nicaragua</option>,<option value="NE">Niger</option>,<option value="NG">Nigeria</option>,<option value="NU">Niue</option>,<option value="NF">Norfolk Island</option>,<option value="MP">Northern Mariana Islands</option>,<option value="NO">Norway</option>,<option value="OM">Oman</option>,<option value="PK">Pakistan</option>,<option value="PW">Palau</option>,<option value="PS">Palestinian Territory, Occupied</option>,<option value="PA">Panama</option>,<option value="PG">Papua New Guinea</option>,<option value="PY">Paraguay</option>,<option value="PE">Peru</option>,<option value="PH">Philippines</option>,<option value="PN">Pitcairn</option>,<option value="PL">Poland</option>,<option value="PT">Portugal</option>,<option value="PR">Puerto Rico</option>,<option value="QA">Qatar</option>,<option value="RE">Reunion</option>,<option value="RO">Romania</option>,<option value="RU">Russian Federation</option>,<option value="RW">RWANDA</option>,<option value="SH">Saint Helena</option>,<option value="KN">Saint Kitts and Nevis</option>,<option value="LC">Saint Lucia</option>,<option value="PM">Saint Pierre and Miquelon</option>,<option value="VC">Saint Vincent and the Grenadines</option>,<option value="WS">Samoa</option>,<option value="SM">San Marino</option>,<option value="ST">Sao Tome and Principe</option>,<option value="SA">Saudi Arabia</option>,<option value="SN">Senegal</option>,<option value="CS">Serbia and Montenegro</option>,<option value="SC">Seychelles</option>,<option value="SL">Sierra Leone</option>,<option value="SG">Singapore</option>,<option value="SK">Slovakia</option>,<option value="SI">Slovenia</option>,<option value="SB">Solomon Islands</option>,<option value="SO">Somalia</option>,<option value="ZA">South Africa</option>,<option value="GS">South Georgia and the South Sandwich Islands</option>,<option value="ES">Spain</option>,<option value="LK">Sri Lanka</option>,<option value="SD">Sudan</option>,<option value="SR">Suriname</option>,<option value="SJ">Svalbard and Jan Mayen</option>,<option value="SZ">Swaziland</option>,<option value="SE">Sweden</option>,<option value="CH">Switzerland</option>,<option value="SY">Syrian Arab Republic</option>,<option value="TW">Taiwan, Province of China</option>,<option value="TJ">Tajikistan</option>,<option value="TZ">Tanzania, United Republic of</option>,<option value="TH">Thailand</option>,<option value="TL">Timor-Leste</option>,<option value="TG">Togo</option>,<option value="TK">Tokelau</option>,<option value="TO">Tonga</option>,<option value="TT">Trinidad and Tobago</option>,<option value="TN">Tunisia</option>,<option value="TR">Turkey</option>,<option value="TM">Turkmenistan</option>,<option value="TC">Turks and Caicos Islands</option>,<option value="TV">Tuvalu</option>,<option value="UG">Uganda</option>,<option value="UA">Ukraine</option>,<option value="AE">United Arab Emirates</option>,<option value="GB">United Kingdom</option>,<option value="US">United States</option>,<option value="UM">United States Minor Outlying Islands</option>,<option value="UY">Uruguay</option>,<option value="UZ">Uzbekistan</option>,<option value="VU">Vanuatu</option>,<option value="VE">Venezuela</option>,<option value="VN">Viet Nam</option>,<option value="VG">Virgin Islands, British</option>,<option value="VI">Virgin Islands, U.S.</option>,<option value="WF">Wallis and Futuna</option>,<option value="EH">Western Sahara</option>,<option value="YE">Yemen</option>,<option value="ZM">Zambia</option>,<option value="ZW">Zimbabwe</option>
              <input id="countrySelect" type="hidden" name="countrySelect">
            </select>
          </div>
          <br>
        </fieldset>
      </div>
      
      <div class="form-group col-md-6">
        <fieldset>
          <label for="order_status" class="control-label">Status</label>
          <select style="display:{{order.isGoods}}" onchange="statusCheck()" class="form-control editInputField" id="order_status" name="order_status">
            <option id="pending"value="PENDING" {{order.pending}}>Pending</option>
            <option id="delivering" value="DELIVERING" {{order.delivering}}>Delivering</option>
            <option id="delivered" value="DELIVERED" {{order.delivered}}>Delivered</option>
          </select>

          <select style="display:{{order.isService}}" onchange="statusCheck()" class="form-control editInputField" id="Sorder_status" name="Sorder_status">
            <option id="pending"value="PENDING" {{order.Spending}}>Pending</option>
            <option id="accepted"value="ACCEPTED">Accepted</option>
            <option id="conpleted" value="COMPLETED" {{order.Sconfirmed}}>Completed</option>
          </select>

        </fieldset>
      </div>
        

    </div>
    <div class="form__btns">
        <button id="editBttns" type='button' class="btn btn-primary" data-toggle="modal" data-target="#popUpWindow">Save</button>
        <div class="container">

        <div class="modal fade" id="popUpWindow">
          <div class="modal-dialog">
            <div class="modal-content">
              <!-- header -->
              <div class="modal-header" style="display: block;">
                <h3 class="modal-title" style="display: inline-block; float:left;">Confirmation</h3>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
              </div>
              <!-- body -->
              <div class="modal-header" style="display: block;">
                  <div style="font-size:50px; width:100%;" class="theModal form-group">
                    Confirm? <br>

                    {{#ifEqual product.product_type "Goods"}}
                    <span style="font-size:18px; display:none; color:black;" id="statusChange">Are you sure this item is delivered?</span>
                    <span style="font-size:18px; display:none; color:black;" id="statusChange2">After it is delivered, the only way to change it is to contact the admins.</span>
                    {{else}}
                    <span style="font-size:18px; display:none; color:black;" id="SstatusChange">Are you sure this is completed?</span>
                    <span style="font-size:18px; display:none; color:black;" id="SstatusChange2">After it is completed, the only way to change it is to contact the admins.</span>
                    {{/ifEqual}}

                  </div>
                  <div class="form-group">
                    <button type='submit' class="theModal btn btn-primary">Update</button>
                  </div>
              </div>

            </div>
          </div>
        </div>

      </div>
  </form>

</div><!-- /form__btns -->
</div><!-- /container -->  

<script>
(async () => {
  const res = await fetch("https://freegeoip.app/json/");
  const json = await res.json();
  document.getElementById("country").value = json.country_code;
})();

function changeCountry() {
  let e = document.getElementById('country');
	let country = e.options[e.selectedIndex].innerHTML;
  document.getElementById('countrySelect').value = country;
};

$( document ).ready(function() {
  check();
  changeCountry();
  statusCheck();
});

$('#order_status').change(() => {
  check();
})

$('#Sorder_status').change(() => {
  check();
})

function check() {
  let delivered = document.getElementById('order_status').selectedIndex;
  let address = document.getElementById('address').value.length;
  let street = document.getElementById('street').value.length;
  let button = document.getElementById('editBttns');
  let status = $("#order_status option:selected").text();
  let Sstatus = $("#Sorder_status option:selected").text();

  {{#ifEqual product.product_type "Goods"}}
  console.log("Goods");
  if ((status.toLowerCase() == 'delivering') || (status.toLowerCase() == 'pending')) {
    if (address < 1 || street < 1) {
        button.disabled = true;
      } else {
        button.disabled = false;
      } 
  } else {
    button.disabled = false;
  }
  {{else}}
  console.log("Service");
  if ((Sstatus.toLowerCase() == 'pending') || (Sstatus.toLowerCase() == 'accepted')) {
    console.log("not completed");
    if (address < 1 || street < 1) {
      button.disabled = true;
    } else {
      button.disabled = false;
    } 
  } else {
    console.log("completed");
    button.disabled = false;
  }
  {{/ifEqual}}

}

$('#editBttns').click(() => {
  let delivered = document.getElementById('order_status').selectedIndex;
  let status = $("#order_status option:selected").text();
  let Sstatus = $("#Sorder_status option:selected").text();

  {{#ifEqual product.product_type "Goods"}}
  console.log('Bttn clicked Goods');
  if (status.toLowerCase() == 'delivered') {
    $("#statusChange").css("display", "block");
    $("#statusChange2").css("display", "block");
  } else {
    $("#statusChange").css("display", "none");
    $("#statusChange2").css("display", "none");
  }
  {{else}}
  console.log('Bttn clicked Service');
  if (Sstatus.toLowerCase() == 'completed') {
    $("#SstatusChange").css("display", "block");
    $("#SstatusChange2").css("display", "block");
  } else {
    $("#SstatusChange").css("display", "none");
    $("#SstatusChange2").css("display", "none");
  }
  {{/ifEqual}}

});

$('#country').blur(() => {
  changeCountry();
});

function statusCheck() {
  let delivered = document.getElementById('order_status').selectedIndex;
  let status = $("#order_status option:selected").text();
  let Sstatus = $("#Sorder_status option:selected").text();
  let destination = document.getElementById('destination');
  let destinationLabel = document.getElementById('destinationLabel');
  let address = document.getElementById('address');
  let addressLabel = document.getElementById('addressLabel');
  let street = document.getElementById('street');
  let streetLabel = document.getElementById('streetLabel');
  let location = document.getElementById('location');
  let locationLabel = document.getElementById('locationLabel');

  {{#ifEqual product.product_type "Goods"}}
  if (status.toLowerCase() == 'delivered') {
    console.log('delivered selected');
    address.style.display = 'none';
    addressLabel.style.display = 'none';
    street.style.display = 'none';
    streetLabel.style.display = 'none';
    destination.style.display = 'block';
    destinationLabel.style.display = 'block';
  } else if (status.toLowerCase() == 'delivering'){
    console.log('delivered not selected');
    address.style.display = 'block';
    addressLabel.style.display = 'block';
    street.style.display = 'block';
    streetLabel.style.display = 'block';
    destination.style.display = 'none';
    destinationLabel.style.display = 'none';
  } else if (status.toLowerCase() == 'pending') {
    console.log('delivered not selected');
    address.style.display = 'block';
    addressLabel.style.display = 'block';
    street.style.display = 'block';
    streetLabel.style.display = 'block';
    destination.style.display = 'none';
    destinationLabel.style.display = 'none';
  }
  {{else}}
  if ((Sstatus.toLowerCase() == 'pending') || (Sstatus.toLowerCase() == 'accepted')) {
    address.style.display = 'block';
    addressLabel.style.display = 'block';
    street.style.display = 'block';
    streetLabel.style.display = 'block';
    location.style.display = 'none';
    locationLabel.style.display = 'none';
  } else {
    address.style.display = 'none';
    addressLabel.style.display = 'none';
    street.style.display = 'none';
    streetLabel.style.display = 'none';
    location.style.display = 'block';
    locationLabel.style.display = 'block';
  }
  {{/ifEqual}}
}


</script>